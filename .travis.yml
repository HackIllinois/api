language: go
go:
    - "1.10.x"
services:
    mongodb
install:
    - go get -t ./...
script:
    - "[ $(gofmt -l . | wc -l) == 0 ]"
    - make all
    - make test
before_deploy:
    - make deploy
deploy:
    provider: s3
    access_key_id: $RP_AWS_ACCESS_KEY
    secret_access_key: $RP_AWS_SECRET_KEY
    bucket: $RP_API_BUILD_BUCKET
    skip_cleanup: true
    local_dir: deploy
    on:
        branch: master
